{{- /*
Ingest RVTools Template - Creates tables from Excel sheets.
All tables use CREATE TABLE AS SELECT * to preserve all columns.
Each line is executed separately to handle missing sheets.
*/ -}}
CREATE TABLE IF NOT EXISTS vinfo AS SELECT * FROM read_xlsx('{{.FilePath}}', sheet='vInfo', all_varchar=true);
CREATE TABLE IF NOT EXISTS vcpu AS SELECT * FROM read_xlsx('{{.FilePath}}', sheet='vCPU', all_varchar=true);
CREATE TABLE IF NOT EXISTS vmemory AS SELECT * FROM read_xlsx('{{.FilePath}}', sheet='vMemory', all_varchar=true);
CREATE TABLE IF NOT EXISTS vdisk AS SELECT * FROM read_xlsx('{{.FilePath}}', sheet='vDisk', all_varchar=true);
CREATE TABLE IF NOT EXISTS vdatastore AS SELECT * FROM read_xlsx('{{.FilePath}}', sheet='vDatastore', all_varchar=true);
CREATE TABLE IF NOT EXISTS vhost AS SELECT * FROM read_xlsx('{{.FilePath}}', sheet='vHost', all_varchar=true);
CREATE TABLE IF NOT EXISTS vhba AS SELECT * FROM read_xlsx('{{.FilePath}}', sheet='vHBA', all_varchar=true);
CREATE TABLE IF NOT EXISTS vnetwork AS SELECT * FROM read_xlsx('{{.FilePath}}', sheet='vNetwork', all_varchar=true);
CREATE TABLE IF NOT EXISTS dvport AS SELECT * FROM read_xlsx('{{.FilePath}}', sheet='dvPort', all_varchar=true);
